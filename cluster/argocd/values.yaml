global:
  domain: argocd.bukla.hu
server:
  pdb:
    enabled: true
  replicas: 1
  ingress:
    ingressClassName: nginx
    https: true
    enabled: true
    annotations:
      nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    hostname: argocd.bukla.hu
    extraTls:
      - hosts:
        - argocd.bukla.hu
        secretName: wildcard-bukla-tls

configs:
  rbac:
    policy.csv: | 
      g, authentik Admins, role:admin
  cm:
    create: true
    dex.config: |
      connectors:
      - config:
          issuer: https://authentik.bukla.hu/application/o/argocd/
          clientID: oU1vXwPUBb2lxv9QvLTaLIc3na2lpkgVbsAaPdky
          clientSecret: $dex.authentik.clientSecret
          insecureEnableGroups: true
          scopes:
            - openid
            - profile
            - email
        name: authentik
        type: oidc
        id: authentik
dex:
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
  volumeMounts:
  - mountPath: /etc/ssl/certs # -- REWWORK THIS!!!
    name: etc-ssl-certs
    readOnly: true

  volumes:
   - name: etc-ssl-certs
     hostPath:
       path: /etc/ssl/certs
       type: DirectoryOrCreate

# url: http://argocd.company
# dex.config: |
#     connectors:
#     - config:
#         issuer: http://authentik.company/application/o/<application slug defined in step 2>/
#         clientID: <client ID from the Provider above>
#         clientSecret: $dex.authentik.clientSecret
#         insecureEnableGroups: true
#         scopes:
#           - openid
#           - profile
#           - email
#       name: authentik
#       type: oidc
#       id: authentik
