grafana:
  enabled: true
  ingress:
    ingressClassName: nginx
    enabled: true
    hosts:
      - grafana.bukla.hu
    tls:
      - secretName: wildcard-bukla-tls
        hosts:
          - grafana.bukla.hu
  persistence:
    enabled: true
    type: sts
    storageClassName: nfs-csi
    accessModes:
      - ReadWriteOnce
    size: 20Gi
  sidecar:
    dashboards:
      enabled: true
    datasources:
      enabled: true
      defaultDatasourceEnabled: true
      isDefaultDatasource: true
      name: Prometheus
      uid: prometheus
  additionalDataSources:
    - name: influxdb
      uri: https://influxdb.bukla.hu
      type: influxdb
      isDefault: false
      jsonData:
        tlsSkipVerify: true
        organization: "bukla"
      editable: true
  #     alertmanager:
  #       enabled: true
  #       name: Alertmanager
  #       uid: alertmanager
  #       handleGrafanaManagedAlerts: false
  #       implementation: prometheus
  extraSecretMounts:
  - name: wildcard-bukla-tls
    mountPath: "/etc/ssl/certs"
    secretName: wildcard-bukla-tls
  grafana.ini:
    "auth.generic_oauth":
      enabled: true
    "auth.anonymous":
      enabled: true
    check_for_updates: "false"
    server:
      root_url: "https://grafana.bukla.hu"
  envFromSecret: "grafana-secret"
  env:
    GF_AUTH_GENERIC_OAUTH_API_URL: https://authentik.bukla.hu/application/o/userinfo/
    GF_AUTH_GENERIC_OAUTH_AUTH_URL: https://authentik.bukla.hu/application/o/authorize/
    GF_AUTH_GENERIC_OAUTH_ENABLED: true
    GF_AUTH_GENERIC_OAUTH_NAME: Authentik
    GF_AUTH_GENERIC_OAUTH_ROLE_ATTRIBUTE_PATH: "contains(groups, 'authentik Admins') && 'Admin' || contains(groups, 'Grafana Editors') && 'Editor' || 'Viewer'"
    GF_AUTH_GENERIC_OAUTH_SCOPES: "openid profile email"
    GF_AUTH_GENERIC_OAUTH_TOKEN_URL: https://authentik.bukla.hu/application/o/token
    GF_AUTH_SIGNOUT_REDIRECT_URL: https://authentik.bukla.hu/application/o/grafana/end-session
    GF_SECURITY_DISABLE_INITIAL_ADMIN_CREATION: true
thanos:
  enabled: false
prometheus:
  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
      - prom-k.bukla.hu
    tls:
      - secretName: wildcard-bukla-tls
        hosts:
          - prom-k.bukla.hu
  # prometheusOperator: #lehet nem kell
  #   admissionWebhooks:
  #     certManager:
  #       enabled: true
  prometheusSpec:
    replicas: 1
    ruleSelectorNiUsesHelmValues: false
    ruleSelector:
      matchLabels:
        rules: bukla
    storageSpec:
      volumeClaimTemplate:
        metadata:
          name: prometheus-data 
        spec:
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              storage: 10Gi
          storageClassName: nfs-csi
alertmanager:
  alertmanagerSpec:
    storage:
      volumeClaimTemplate:
        metadata:
          name: alertmanager-data
        spec:
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              storage: 1Gi
          storageClassName: nfs-csi
  ingress:
    ingressClassName: nginx
    enabled: true
    hosts:
      - alertmanager-k.bukla.hu
    tls:
      - secretName: wildcard-bukla-tls
        hosts:
          - alertmanager-k.bukla.hu
